{"version":3,"file":"static/js/8164.4a84a463.chunk.js","mappings":"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","sources":["api/NotificationApi.js","webpack://tradersplus/./src/views/tradersplusComponents/Notifications/webLimitedNotification.module.css?3075","views/tradersplusComponents/Notifications/WebLimitedNotification.js"],"sourcesContent":["import { api , apiWithHeader, apiWithPasswordHeader } from \"./api\";\n\nexport const enableNotification = (data ,callback) => {\n    api().post(`/enable-notif` ,data).then((response) => {\n        const data = response.data\n        console.log(response);\n        return callback(true ,response)\n        }\n    ).catch(err => {\n        console.log(err);\n        return callback(false ,err)\n    })\n}\n\nexport const getNotifications = (callback) => {\n    api().get(`/admin/notification-report` ).then((response) => {\n        const data = response.data\n        console.log(response);\n        return callback(true ,data)\n        }\n    ).catch(err => {\n        console.log(err);\n        return callback(false ,err)\n    })\n}\n\nexport const getWebTokensNotification = (callback) => {\n    apiWithPasswordHeader().get(`/admin/get-notification-token` ).then((response) => {\n        const data = response.data\n        console.log(response);\n        return callback(true ,data)\n        }\n    ).catch(err => {\n        console.log(err);\n        return callback(false ,err)\n    })\n}\n\nexport const sendWebNotification = (data ,callback) => {\n    apiWithPasswordHeader().post(`/admin/send-web-notification` ,data).then((response) => {\n        const data = response.data\n        console.log(response);\n        return callback(true ,data)\n        }\n    ).catch(err => {\n        console.log(err);\n        return callback(false ,err)\n    })\n}\n\nexport const sendLimitedWebNotification = (data ,callback) => {\n    apiWithPasswordHeader().post(`/admin/send-limited-web-notification` ,data).then((response) => {\n        const data = response.data\n        console.log(response);\n        return callback(true ,data)\n        }\n    ).catch(err => {\n        console.log(err);\n        return callback(false ,err)\n    })\n}","// extracted by mini-css-extract-plugin\nexport default {\"formContainer\":\"webLimitedNotification_formContainer__hgtMh\",\"link\":\"webLimitedNotification_link__ptfLA\"};","import { Button, Select } from \"antd\";\nimport React, { useEffect } from \"react\";\nimport { useState } from \"react\";\n\nimport { Form } from \"react-bootstrap\";\nimport { toast } from \"react-toastify\";\nimport {\n  getWebTokensNotification,\n  sendLimitedWebNotification,\n} from \"src/api/NotificationApi\";\n\nimport styles from \"./webLimitedNotification.module.css\";\n\nconst WebNotification = () => {\n  const { Option } = Select;\n\n  const [loadingBtn, setLoadingBtn] = useState(false);\n  const [selectedItems, setSelectedItems] = useState([]);\n  const [notificationData, setNotificationData] = useState({\n    title: \"\",\n    body: \"\",\n  });\n\n  const [notificationResult, setNotificationResult] = useState({\n    success: 0,\n    failure: 0,\n  });\n\n  const [selectedTokens, setSelectedTokens] = useState([]);\n\n  const [showResult, setShowResult] = useState(false);\n\n  useEffect(() => {\n    getWebTokensNotification((isOk, info) => {\n      if (isOk) {\n        console.log(info);\n        return setSelectedTokens(info.users);\n      }\n      return toast.error(\"خطا در دریافت اطلاعات\");\n    });\n  }, []);\n\n  const changeHandler = (e) => {\n    setNotificationData({\n      ...notificationData,\n      [e.target.name]: e.target.value,\n    });\n  };\n\n  const submitHandler = async (e) => {\n    const data = {\n      tokens: [...selectedItems],\n      title: notificationData.title,\n      body: notificationData.body,\n    };\n    sendLimitedWebNotification(data, (isOk, info) => {\n      if (isOk) {\n        setNotificationResult({\n          success: info.response.success,\n          failure: info.response.failure,\n        });\n        return setShowResult(true);\n      }\n      return toast.error(\"خطا در ارسال اعلان\");\n    });\n  };\n\n  const filteredOptions = selectedTokens.filter(\n    (o) => !selectedItems.includes(o)\n  );\n\n  return (\n    <Form onSubmit={submitHandler} className={styles.formContainer}>\n      <Form.Group className=\"mb-3 w-100\" controlId=\"exampleForm.ControlInput1\">\n        <Select\n          mode=\"multiple\"\n          placeholder=\"انتخاب کاربر\"\n          value={selectedItems}\n          onChange={setSelectedItems}\n          style={{\n            width: \"100%\",\n            margin:\"1rem 0\",\n            textAlign:\"right\"\n          }}\n          options={filteredOptions.map((item) => ({\n            value: item.web_notification_token,\n            label: item.mobileNumber,\n          }))}\n        />\n        <Form.Control\n          onChange={changeHandler}\n          value={notificationData.title}\n          type=\"text\"\n          name=\"title\"\n          dir=\"rtl\"\n          placeholder=\"نام پیام\"\n          className=\"w-100\"\n        />\n      </Form.Group>\n      <Form.Group\n        className=\"mb-3 w-100\"\n        controlId=\"exampleForm.ControlTextarea1\"\n      >\n        <Form.Control\n          onChange={changeHandler}\n          value={notificationData.body}\n          as=\"textarea\"\n          name=\"body\"\n          dir=\"rtl\"\n          placeholder=\"متن پیام\"\n          className=\"w-100\"\n          rows={3}\n          style={{ resize: \"none\" }}\n        />\n      </Form.Group>\n\n      <div className=\"col-md-2 w-100 d-flex justify-content-end mt-3 \">\n        <Button\n          type=\"primary\"\n          loading={loadingBtn}\n          onClick={submitHandler}\n          className=\"mb-2\"\n        >\n          ارسال پیام\n        </Button>\n      </div>\n      {showResult && (\n        <div className={styles.showResultContainer}>\n          <p> ارسال موفق : {notificationResult.success} </p>\n          <p> ارسال ناموفق : {notificationResult.failure} </p>\n        </div>\n      )}\n    </Form>\n  );\n};\n\nexport default WebNotification;\n"],"names":["enableNotification","data","callback","api","post","then","response","console","log","catch","err","getNotifications","get","getWebTokensNotification","apiWithPasswordHeader","sendWebNotification","sendLimitedWebNotification","Select","_useState","useState","_useState2","_slicedToArray","loadingBtn","_useState3","_useState4","selectedItems","setSelectedItems","_useState5","title","body","_useState6","notificationData","setNotificationData","_useState7","success","failure","_useState8","notificationResult","setNotificationResult","_useState9","_useState10","selectedTokens","setSelectedTokens","_useState11","_useState12","showResult","setShowResult","useEffect","isOk","info","users","toast","changeHandler","e","_objectSpread","_defineProperty","target","name","value","submitHandler","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","tokens","_toConsumableArray","stop","_x","apply","arguments","filteredOptions","filter","o","includes","_jsxs","Form","onSubmit","className","styles","children","controlId","_jsx","mode","placeholder","onChange","style","width","margin","textAlign","options","map","item","web_notification_token","label","mobileNumber","type","dir","as","rows","resize","Button","loading","onClick"],"sourceRoot":""}